<view class="leaders-page">
  <!-- 页面头部 -->
  <view class="page-header">
    <view class="container">
      <text class="page-title">社区带领人</text>
      <text class="page-subtitle">他们是社区的引路人，用智慧和热情引领大家前行</text>
    </view>
  </view>

  <!-- 筛选区域 -->
  <view class="filters-section">
    <view class="container">
      <view class="filters-content">
        <!-- 街道筛选 (下拉模式) -->
        <view class="dropdown-filter">
          <view class="dropdown-trigger" bindtap="toggleStreetDropdown">
            <text class="dropdown-text">{{selectedStreetText}}</text>
            <view class="dropdown-arrow {{streetDropdownOpen ? 'open' : ''}}">▼</view>
          </view>
          <view class="dropdown-options {{streetDropdownOpen ? 'show' : ''}}">
            <view
              class="dropdown-option {{selectedStreet === '' ? 'selected' : ''}}"
              bindtap="onStreetFilter"
              data-street=""
            >
              全部街道
            </view>
            <view
              wx:for="{{streets}}"
              wx:key="*this"
              class="dropdown-option {{selectedStreet === item ? 'selected' : ''}}"
              bindtap="onStreetFilter"
              data-street="{{item}}"
            >
              {{item}}
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 带领人列表 -->
  <view class="leaders-section">
    <view class="container">
      <!-- 1. 金牌带领人荣誉榜 (横向滚动) -->
      <view wx:if="{{ goldLeaders.length > 0 }}" class="gold-section">
        <view class="section-title">🌟 金牌带领人</view>
        <scroll-view class="gold-scroll" scroll-x="{{ true }}" enable-flex="{{ true }}">
          <view class="gold-list">
            <view 
              wx:for="{{ goldLeaders }}" 
              wx:key="_id" 
              class="gold-card" 
              bindtap="onLeaderTap" 
              data-id="{{ item._id }}"
            >
              <view class="gold-avatar-wrapper">
                <image src="{{ item.photo }}" class="gold-avatar" mode="aspectFill" />
                <view class="gold-badge">🏆</view>
              </view>
              <text class="gold-name">{{ item.name }}</text>
              <text class="gold-street">{{ item.street }}</text>
            </view>
          </view>
        </scroll-view>
      </view>

      <!-- 2. 普通带领人列表 -->
      <view class="section-title" wx:if="{{ leaders.length > 0 }}">社区带领人</view>
      
      <!-- 加载状态 -->
      <view wx:if="{{ loading }}" class="loading">
        <text>加载中...</text>
      </view>

      <!-- 空状态 -->
      <view wx:elif="{{ leaders.length === 0 && goldLeaders.length === 0 }}" class="empty-state">
        <text class="empty-text">暂无带领人数据</text>
      </view>

      <!-- 带领人列表 -->
      <view wx:else class="leaders-list">
        <leader-card
          wx:for="{{ leaders }}"
          wx:key="_id"
          leader="{{ item }}"
          bind:click="onLeaderTap"
          binderror="onImageError"
        />
      </view>

      <!-- 加载更多 -->
      <view wx:if="{{ hasMore && !loading }}" class="load-more">
        <button class="btn btn-primary" bindtap="onLoadMore">加载更多</button>
      </view>

      <!-- 没有更多数据 -->
      <view wx:if="{{ !hasMore && leaders.length > 0 }}" class="no-more">
        <text>没有更多数据了</text>
      </view>
    </view>
  </view>
</view>
